<!DOCTYPE html>
<html>
  <head>
    <title>Retirement Planning Calculator</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/css/bootstrap.min.css"
    />
  </head>
  <body>
    <div class="container mt-5">
      <h2 style="color: #361cc1;;">Retirement Calculator</h2>
      <br>
      <div class="row">
        <!-- Div 1: Age related inputs -->
        <div class="col-lg-4 col-md-6 mb-3">
          <h3>Age</h3>
          <div class="form-group">
            <label for="currentAge">Current Age</label>
            <input
              type="number"
              class="form-control"
              id="currentAge"
              required
            />
          </div>
          <br>
          <div class="form-group">
            <label for="retirementAge">Retirement Age</label>
            <input
              type="number"
              class="form-control"
              id="retirementAge"
              required
            />
          </div>
          <br>
          <div class="form-group">
            <label for="lifeExpectancy">Life Expectancy Age</label>
            <input
              type="number"
              class="form-control"
              id="lifeExpectancy"
              required
            />
          </div>
        </div>

        <!-- Div 2: Rate related inputs -->
        <div class="col-lg-4 col-md-6 mb-3">
          <h3>Rate(%)</h3>
          <div class="form-group">
            <label for="inflationRate">Rate of Inflation (%)</label>
            <input
              type="number"
              class="form-control"
              id="inflationRate"
              required
            />
          </div>
          <br>
          <div class="form-group">
            <label for="postTaxReturnRate">Post Tax Rate of Return (%)</label>
            <input
              type="number"
              class="form-control"
              id="postTaxReturnRate"
              required
            />
          </div>
          <br>
          <div class="form-group">
            <label for="currentInvestmentRate"
              >Current Investment Rate (%)</label
            >
            <input
              type="number"
              class="form-control"
              id="currentInvestmentRate"
              required
            />
          </div>
        </div>

        <!-- Div 3: Money related inputs -->
        <div class="col-lg-4 col-md-12 mb-3">
          <h3>Expenses</h3>
          <div class="form-group">
            <label for="currentExpenses">Current Expenses (per month)</label>
            <input
              type="number"
              class="form-control"
              id="currentExpenses"
              required
            />
          </div><br>
          <div class="form-group">
            <label for="retirementCorpus">Amount you already have (Rs.)</label>
            <input
              type="number"
              class="form-control"
              id="retirementCorpus"
              required
            />
          </div>
        </div>
      </div>

      <button
        type="button"
        class="btn btn-primary"
        onclick="calculateRetirement(),document.getElementById('hiddenElement').style.display = 'block';"
      >
        Calculate
      </button>
      <h3 class="mt-4"></h3>
      <div id="hiddenElement" class="hiddenElement">
      <div class="row">
        <div class="col">
          <div class="wrapper">
          <p1><span style="color: black;">Future Value of Expenses = </span>
          <span style="font-weight: bold; font-size: 1.5em;">Rs.</span>
          <span style="font-weight: bold; font-size: 1.5em;" id="futureExpenses"></span></p1><Br>
          <p1><span style="color: black;">Corpus required at the Age of retirement = </span>
          <span style="font-weight: bold; font-size: 1.5em;">Rs.</span> 
          <span style="font-weight: bold; font-size: 1.5em;" id="corpusRequiredAtRetirement"></span>
          </p>
          <p1><span style="color: black;"> How much SIP is required to save (per month) = </span>
          <span style="font-weight: bold; font-size: 1.5em;">Rs.</span> 
          <span style="font-weight: bold; font-size: 1.5em;" id="sipRequired"></span></p1>
        </div>
        <br><br>
        <p class="text-end">*Figures may vary by a few pointers</p>
        <p class="text-end">*This is for educational purposes only</p>
      </div>
      </div>
      </div> 
    </div>

    <script>
      function calculateRetirement() {
        const currentAge = parseFloat(
          document.getElementById("currentAge").value
        );
        const retirementAge = parseFloat(
          document.getElementById("retirementAge").value
        );
        const lifeExpectancy = parseFloat(
          document.getElementById("lifeExpectancy").value
        );
        const inflationRate =
          parseFloat(document.getElementById("inflationRate").value) / 100;
        const currentExpenses = parseFloat(
          document.getElementById("currentExpenses").value
        );
        const postTaxReturnRate =
          parseFloat(document.getElementById("postTaxReturnRate").value) / 100;
        const retirementCorpus = parseFloat(
          document.getElementById("retirementCorpus").value
        );
        const currentInvestmentRate =
          parseFloat(document.getElementById("currentInvestmentRate").value) /
          100;

        const yearsToRetirement = retirementAge - currentAge;
        const postRetirementYears = lifeExpectancy - retirementAge;
        const ageDifferenceMonths = postRetirementYears * 12;

        const futureExpenses =
          currentExpenses * Math.pow(1 + inflationRate, yearsToRetirement);
        const realRateOfReturn =
          (postTaxReturnRate - inflationRate) / (1 + inflationRate);
        //   Math.pow(1 + currentInvestmentRate, 1 + postTaxReturnRate) - 1;
        const Nominal =
          (12 * (Math.pow(1 + realRateOfReturn, 1 / 12) - 1)) / 12;
        const corpusRequiredAtRetirement =
          futureExpenses *
          ((1 - Math.pow(1 + Nominal, -ageDifferenceMonths)) / Nominal);

        const corpusRaisedtoYears = 
          retirementCorpus * (Math.pow((1+currentInvestmentRate), yearsToRetirement));

        const subtractFromPresentValue =
          corpusRequiredAtRetirement - corpusRaisedtoYears;
          
        const sipYearly = 
          (subtractFromPresentValue*currentInvestmentRate)/Math.pow(1+currentInvestmentRate,yearsToRetirement);

        const sipRequired =
          sipYearly / 12;
        document.getElementById("futureExpenses").innerText =
          futureExpenses.toFixed(2);
        document.getElementById("corpusRequiredAtRetirement").innerText =
          corpusRequiredAtRetirement.toFixed(2);
        document.getElementById("sipRequired").innerText =
          sipRequired.toFixed(2);
      }
    </script>
  </body>
</html>
