<!DOCTYPE html>
<html>
  <head>
    <title>Retirement Planning Calculator</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
  </head>
  <body>
    <div class="container mt-5">
      <h2>Retirement Planning Calculator</h2>
      <form>
        <div class="form-group">
          <label for="currentAge">Current Age:</label>
          <input type="number" class="form-control" id="currentAge" required />
        </div>
        <div class="form-group">
          <label for="retirementAge">Retirement Age:</label>
          <input
            type="number"
            class="form-control"
            id="retirementAge"
            required
          />
        </div>
        <div class="form-group">
          <label for="lifeExpectancy">Life Expectancy Age:</label>
          <input
            type="number"
            class="form-control"
            id="lifeExpectancy"
            required
          />
        </div>
        <div class="form-group">
          <label for="inflationRate">Rate of Inflation (%):</label>
          <input
            type="number"
            class="form-control"
            id="inflationRate"
            required
          />
        </div>
        <div class="form-group">
          <label for="currentExpenses">Current Expenses (per month):</label>
          <input
            type="number"
            class="form-control"
            id="currentExpenses"
            required
          />
        </div>
        <div class="form-group">
          <label for="postTaxReturnRate">Post Tax Rate of Return (%):</label>
          <input
            type="number"
            class="form-control"
            id="postTaxReturnRate"
            required
          />
        </div>
        <div class="form-group">
          <label for="retirementCorpus"
            >Amount you already have for retirement corpus:</label
          >
          <input
            type="number"
            class="form-control"
            id="retirementCorpus"
            required
          />
        </div>
        <div class="form-group">
          <label for="currentInvestmentRate"
            >Current investment Rate (%):</label
          >
          <input
            type="number"
            class="form-control"
            id="currentInvestmentRate"
            required
          />
        </div>
        <button
          type="button"
          class="btn btn-primary"
          onclick="calculateRetirement()"
        >
          Calculate
        </button>
      </form>

      <h3 class="mt-4">Output:</h3>
      <div class="row">
        <div class="col">
          <p>
            Number of years to retirement: <span id="yearsToRetirement"></span>
          </p>
          <p>
            Post Retirement number of years:
            <span id="postRetirementYears"></span>
          </p>
          <p>
            Months calculation for age difference:
            <span id="ageDifferenceMonths"></span>
          </p>
          <p>Future value of Expenses: <span id="futureExpenses"></span></p>
          <p>Real Rate of Return (%): <span id="realRateOfReturn"></span></p>
          <p>
            Corpus required at the Age of retirement:
            <span id="corpusRequiredAtRetirement"></span>
          </p>
          <p>
            How much SIP is required to save (per month):
            <span id="sipRequired"></span>
          </p>
        </div>
      </div>
    </div>

    <script>
      function calculateRetirement() {
        const currentAge = parseFloat(
          document.getElementById("currentAge").value
        );
        const retirementAge = parseFloat(
          document.getElementById("retirementAge").value
        );
        const lifeExpectancy = parseFloat(
          document.getElementById("lifeExpectancy").value
        );
        const inflationRate =
          parseFloat(document.getElementById("inflationRate").value) / 100;
        const currentExpenses = parseFloat(
          document.getElementById("currentExpenses").value
        );
        const postTaxReturnRate =
          parseFloat(document.getElementById("postTaxReturnRate").value) / 100;
        const retirementCorpus = parseFloat(
          document.getElementById("retirementCorpus").value
        );
        const currentInvestmentRate =
          parseFloat(document.getElementById("currentInvestmentRate").value) /
          100;

        const yearsToRetirement = retirementAge - currentAge;
        const postRetirementYears = lifeExpectancy - retirementAge;
        const ageDifferenceMonths = postRetirementYears * 12;

        const futureExpenses =
          currentExpenses * Math.pow(1 + inflationRate, yearsToRetirement);
        const realRateOfReturn =
          (postTaxReturnRate - inflationRate) / (1 + inflationRate);
        //   Math.pow(1 + currentInvestmentRate, 1 + postTaxReturnRate) - 1;
        const Nominal =
          (12 * (Math.pow(1 + realRateOfReturn, 1 / 12) - 1)) / 12;
        const corpusRequiredAtRetirement =
          futureExpenses *
          ((1 - Math.pow(1 + Nominal, -ageDifferenceMonths)) / Nominal);
      
        const corpusRaisedtoYears = 
          retirementCorpus * (Math.pow((1+currentInvestmentRate), yearsToRetirement));
        
        const subtractFromPresentValue =
          corpusRequiredAtRetirement - corpusRaisedtoYears;
        
        const sipYearly = 
          (subtractFromPresentValue*currentInvestmentRate)/Math.pow(1+currentInvestmentRate,yearsToRetirement);
        

        const sipRequired =
          sipYearly / 12;

        document.getElementById("yearsToRetirement").innerText =
          yearsToRetirement;
        document.getElementById("postRetirementYears").innerText =
          postRetirementYears;
        document.getElementById("ageDifferenceMonths").innerText =
          ageDifferenceMonths;
        document.getElementById("futureExpenses").innerText =
          futureExpenses.toFixed(2);
        document.getElementById("realRateOfReturn").innerText = (
          realRateOfReturn * 100
        ).toFixed(2);
        document.getElementById("corpusRequiredAtRetirement").innerText =
          corpusRequiredAtRetirement.toFixed(2);
        document.getElementById("sipRequired").innerText =
          sipRequired.toFixed(2);
      }
    </script>
  </body>
</html>
