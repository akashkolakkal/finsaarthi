<!DOCTYPE html>
<html>
  <head>
    <title>Retirement Planning Calculator</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/css/bootstrap.min.css"
    />
  </head>
  <body>
    <div class="container mt-5">
      <h2>Retirement Calculator</h2>
      <div class="row">
        <!-- Div 1: Age related inputs -->
        <div class="col-lg-4 col-md-6 mb-3">
          <h3>Age</h3>
          <div class="form-group">
            <label for="currentAge">Current Age:</label>
            <input
              type="number"
              class="form-control"
              id="currentAge"
              required
            />
          </div>
          <div class="form-group">
            <label for="retirementAge">Retirement Age:</label>
            <input
              type="number"
              class="form-control"
              id="retirementAge"
              required
            />
          </div>
          <div class="form-group">
            <label for="lifeExpectancy">Life Expectancy Age:</label>
            <input
              type="number"
              class="form-control"
              id="lifeExpectancy"
              required
            />
          </div>
        </div>

        <!-- Div 2: Rate related inputs -->
        <div class="col-lg-4 col-md-6 mb-3">
          <h3>Rate</h3>
          <div class="form-group">
            <label for="inflationRate">Rate of Inflation (%):</label>
            <input
              type="number"
              class="form-control"
              id="inflationRate"
              required
            />
          </div>
          <div class="form-group">
            <label for="postTaxReturnRate">Post Tax Rate of Return (%):</label>
            <input
              type="number"
              class="form-control"
              id="postTaxReturnRate"
              required
            />
          </div>
          <div class="form-group">
            <label for="currentInvestmentRate"
              >Current Investment Rate (%):</label
            >
            <input
              type="number"
              class="form-control"
              id="currentInvestmentRate"
              required
            />
          </div>
        </div>

        <!-- Div 3: Money related inputs -->
        <div class="col-lg-4 col-md-12 mb-3">
          <h3>Money</h3>
          <div class="form-group">
            <label for="currentExpenses">Current Expenses (per month):</label>
            <input
              type="number"
              class="form-control"
              id="currentExpenses"
              required
            />
          </div>
          <div class="form-group">
            <label for="retirementCorpus">Amount you already have:</label>
            <input
              type="number"
              class="form-control"
              id="retirementCorpus"
              required
            />
          </div>
        </div>
      </div>

      <button
        type="button"
        class="btn btn-primary"
        onclick="calculateRetirement()"
      >
        Calculate
      </button>
      <h3 class="mt-4">Output:</h3>
      <div class="row">
        <div class="col-lg-4 col-md-6 mb-3 d-flex justify-content-between">
          <p>FV of Expenses:</p>
          <p class="font-weight-bold"><span id="futureExpenses"></span></p>
        </div>
        <div class="col-lg-4 col-md-6 mb-3 d-flex justify-content-between">
          <p>Corpus required at the Age of retirement:</p>
          <p class="font-weight-bold">
            <span id="corpusRequiredAtRetirement"></span>
          </p>
        </div>
        <div class="col-lg-4 col-md-12 mb-3 d-flex justify-content-between">
          <p>How much SIP is required to save (per month):</p>
          <p class="font-weight-bold"><span id="sipRequired"></span></p>
        </div>
      </div>
    </div>

    <script>
      function calculateRetirement() {
        const currentAge = parseFloat(
          document.getElementById("currentAge").value
        );
        const retirementAge = parseFloat(
          document.getElementById("retirementAge").value
        );
        const lifeExpectancy = parseFloat(
          document.getElementById("lifeExpectancy").value
        );
        const inflationRate =
          parseFloat(document.getElementById("inflationRate").value) / 100;
        const currentExpenses = parseFloat(
          document.getElementById("currentExpenses").value
        );
        const postTaxReturnRate =
          parseFloat(document.getElementById("postTaxReturnRate").value) / 100;
        const retirementCorpus = parseFloat(
          document.getElementById("retirementCorpus").value
        );
        const currentInvestmentRate =
          parseFloat(document.getElementById("currentInvestmentRate").value) /
          100;

        const yearsToRetirement = retirementAge - currentAge;
        const postRetirementYears = lifeExpectancy - retirementAge;
        const ageDifferenceMonths = postRetirementYears * 12;

        const futureExpenses =
          currentExpenses * Math.pow(1 + inflationRate, yearsToRetirement);
        const realRateOfReturn =
          (postTaxReturnRate - inflationRate) / (1 + inflationRate);
        //   Math.pow(1 + currentInvestmentRate, 1 + postTaxReturnRate) - 1;
        const Nominal =
          (12 * (Math.pow(1 + realRateOfReturn, 1 / 12) - 1)) / 12;
        const corpusRequiredAtRetirement =
          futureExpenses *
          ((1 - Math.pow(1 + Nominal, -ageDifferenceMonths)) / Nominal);

        const corpusRaisedtoYears = 
          retirementCorpus * (Math.pow((1+currentInvestmentRate), yearsToRetirement));

        const subtractFromPresentValue =
          corpusRequiredAtRetirement - corpusRaisedtoYears;
          
        const sipYearly = 
          (subtractFromPresentValue*currentInvestmentRate)/Math.pow(1+currentInvestmentRate,yearsToRetirement);

        const sipRequired =
          sipYearly / 12;
        document.getElementById("futureExpenses").innerText =
          futureExpenses.toFixed(2);
        document.getElementById("corpusRequiredAtRetirement").innerText =
          corpusRequiredAtRetirement.toFixed(2);
        document.getElementById("sipRequired").innerText =
          sipRequired.toFixed(2);
      }
    </script>
  </body>
</html>
